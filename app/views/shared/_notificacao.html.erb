<script>
    function toastify(message, type) {
        toastr.options = {
            "closeButton": true,
            "debug": false,
            "newestOnTop": false,
            "progressBar": true,
            "positionClass": "toastr-top-center",
            "preventDuplicates": false,
            "onclick": null,
            "showDuration": "300",
            "hideDuration": "1000",
            "timeOut": "5000",
            "extendedTimeOut": "1000",
            "showEasing": "swing",
            "hideEasing": "linear",
            "showMethod": "fadeIn",
            "hideMethod": "fadeOut"
        };

        if (type == 'error') {
            toastr.error(message);
        } else if (type == 'success') {
            toastr.success(message);
        } else if  (type == 'warning') {
            toastr.warning(message);
        } else {
            toastr.warning(message);
        }       
    }

    function flashMessages(type,msg){
        switch(type){
            case "alert":
                toastify(msg, "error");
                break;
            case "error":
                toastify(msg, "error");
                break;
            case "notice":
                toastify(msg, "success");
                break;
            case "warning":
                toastify(msg, "warning");
                break;
            case "info":
                toastify(msg, "info");
                break;
        }
    } 
    $(document).ready(function(){
        var flash=<%=flash.to_json.html_safe%>;
        $.each(flash,function(index,value){
            toastify(value[1], value[0]);
        })
    });
    $(document).ajaxComplete(function(event,request){
        var msg=decodeURIComponent(escape(request.getResponseHeader('X-Message')));
        var type=request.getResponseHeader('X-Message-Type');

        if (msg != null && msg != 'error, warning, notice' && type != null && type != '[:error, :warning, :notice]')  {
           toastify(msg, type);
        }
    });
</script>